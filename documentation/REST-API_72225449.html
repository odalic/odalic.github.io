<!DOCTYPE html>
<html>
    <head>
        <title>ADEQUATE : REST API</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">ADEQUATE</a></span>
                            </li>
                                                    <li>
                                <span><a href="Odalic_71438906.html">Odalic</a></span>
                            </li>
                                                    <li>
                                <span><a href="72222608.html">Architecture / Developer Documentation</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            ADEQUATE : REST API
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                        
        
    
        
    
        
        
            Created by <span class='author'> István Satmári</span>, last modified on Jun 01, 2016
                        </div>
                    <div id="main-content" class="wiki-content group">
                    <h2 id="RESTAPI-AproposalforbasicRESTAPIwithoutanydetailedspecificationofthedataexchanged."><strong><span class="inline-comment-marker" data-ref="55da5520-24aa-4dd1-b8e9-3f8414d117b0">A proposal for basic REST API without any detailed specification of the data exchanged.</span></strong></h2><p>Again, all comments, observations and criticism is welcome. If you find something you (even slightly) disagree with, please, let me know. This is a work in progress, it may be changed.</p><p style="margin-left: 30.0px;">- Istvan</p><p>A useful resource on REST practices and recommendations: <a href="http://www.restapitutorial.com/resources.html" class="external-link" rel="nofollow">http://www.restapitutorial.com/resources.html</a></p><h3 id="RESTAPI-Signingup">Signing up</h3><ul><li>Before we dig deeper, an important observation is that signing up via REST API is a potential <u>vulnerability</u> of the system. Consider, for instance, bots creating hundreds of users each second.</li><li>Therefore we require each user to be conncetced with a unique e-mail address. The address should be verified via a confirmation e-mail.</li><li>(1) <strong>PUT</strong> <span class="nolink">http://example.com/<strong>users/John</strong></span></li><li>Query (1) creates a new user in the system, identified by <strong>'John'</strong>. The user is created temporarily, e.g. for 24 hours. As for the sent data, it should contain at least:<ul><li>Password<strong> </strong><em>(We assume the communication is safe and an SSL certificate is used, see 'Authentication' service.)</em></li><li>E-mail <em>(Where to send the confirmation e-mail to.)</em></li></ul></li><li>The user is created only if:<ul><li>The user '<strong>John</strong>' does not exist yet, not even temporarily.</li><li>The sent data is correct, i.e. the format is parse-able and it contains the required fields, such as 'password' and 'e-mail'.</li></ul></li><li>A confirmation e-mail with a link <em>(see below)</em> is sent to the provided e-mail address. If the sent link is not used for the aforementioned time period, the user is deleted.</li><li>Additionally, until the link is used, the user shall not be able to use 'Authentication' service (and thus no service at all).</li><li>(2) <strong style="line-height: 1.42857;">PUT</strong> <span class="nolink" style="line-height: 1.42857;">http://example.com/<strong>users/</strong>John<strong>?key=&quot;154c8095f4b7d01f&quot;</strong></span><ul><li><span class="nolink" style="line-height: 1.42857;">Another option, if we are to avoid GET parameters in the REST API, is to use:</span></li><li><span class="nolink" style="line-height: 1.42857;"><span>(2) </span><strong>PUT</strong><span> </span><span class="nolink">http://example.com/<strong>users/</strong>John/<strong>key/ </strong><em>(and provide &quot;154c8095f4b7d01f&quot; in the sent data)</em></span></span></li></ul></li><li>The query (2) makes the newly created user permanent.</li><li>The key part in the query (2) is provided via the confirmation e-mail. It shall be long enough to be impossible to 'guess'.</li><li><span class="nolink" style="line-height: 1.42857;">The query (2) shall not be the same as the link in the confirmation e-mail. </span><ul><li><em><span class="nolink" style="line-height: 1.42857;">Why? Because when striving for user-friendliness, we need to provide a link that displays a complete HTML page with '&lt;h1&gt;Success&lt;/h1&gt;', or similar.</span></em></li><li><span class="nolink" style="line-height: 1.42857;">However, the confirmation e-mail may contain the link (2) as well <em>(for programmers, presumably)</em>.</span></li><li><span class="nolink" style="line-height: 1.42857;">The important thing is, the </span>key parameter <strong style="line-height: 1.42857;">&quot;key=&quot;154c8095f4b7d01f&quot;</strong>&quot; stays the same in both cases.</li></ul></li></ul><h3 id="RESTAPI-Authentication">Authentication</h3><ul><li>(1) <a href="http://stackoverflow.com/questions/319530/restful-authentication" style="line-height: 1.42857;" class="external-link" rel="nofollow">http://stackoverflow.com/questions/319530/restful-authentication</a></li><li>(2) <a href="http://broadcast.oreilly.com/2009/12/principles-for-standardized-rest-authentication.html" class="external-link" rel="nofollow">http://broadcast.oreilly.com/2009/12/principles-for-standardized-rest-authentication.html</a></li><li>(3) <a href="https://en.wikipedia.org/wiki/Basic_access_authentication" class="external-link" rel="nofollow">https://en.wikipedia.org/wiki/Basic_access_authentication</a></li><li>An SSL certificate should probably be used. We need to encrypt the URL and 'GET parameters' when they are provided.</li></ul><ul><li>Requirement: REST API should be as stateless as possible</li><li>The previous suggestion had certain flaws and was impractical. On this page I propose using the same authentication method, as was used in the UnifiedViews REST API.</li><li><em>That is also the first suggestion in (1).</em></li><li><span class="inline-comment-marker" data-ref="ea46d6b8-8190-4464-ba07-192bbc88ab9c">(4) </span><strong><span class="inline-comment-marker" data-ref="ea46d6b8-8190-4464-ba07-192bbc88ab9c">VERB</span></strong><strong><span class="inline-comment-marker" data-ref="ea46d6b8-8190-4464-ba07-192bbc88ab9c"> </span></strong><span class="nolink"><span class="inline-comment-marker" data-ref="ea46d6b8-8190-4464-ba07-192bbc88ab9c">http://<strong>username:password</strong>@example.com/</span><strong><span class="inline-comment-marker" data-ref="ea46d6b8-8190-4464-ba07-192bbc88ab9c">service/additional_params</span></strong></span></li><li><span class="nolink"><strong><span class="inline-comment-marker" data-ref="ea46d6b8-8190-4464-ba07-192bbc88ab9c"><a href="https://en.wikipedia.org/wiki/Basic_access_authentication" class="external-link" rel="nofollow">https://en.wikipedia.org/wiki/Basic_access_authentication</a></span></strong></span></li><li><span class="nolink"><span class="inline-comment-marker" data-ref="ea46d6b8-8190-4464-ba07-192bbc88ab9c">This should 'construct' http authorization header and pass it to server.</span></span></li><li>Where <strong>username </strong>and<strong> password </strong>are that of a user<ul><li>The username may be either 'username' specified earlier <em>(in the 'Sign up' service)</em>, or an e-mail <em>(specified earlier as well)</em>.</li></ul></li><li>Because of an SSL, this method of authentication should be secure.</li></ul><ul><li>Terminology used:</li><li><strong>VERB </strong>= GET / POST / PUT / DELETE. Additional <span class="inline-comment-marker" data-ref="cb06501c-d456-4d77-9a5b-87508c1f185f">http methods</span> are not necessary for now.</li><li><strong><span class="inline-comment-marker" data-ref="625bf25f-20d1-415d-bdee-1ce936573dd5">Privileged action</span></strong><span class="inline-comment-marker" data-ref="625bf25f-20d1-415d-bdee-1ce936573dd5"> = any action a user can take after a successful authentication. In ODALIC there is almost no action </span><em><span class="inline-comment-marker" data-ref="625bf25f-20d1-415d-bdee-1ce936573dd5">(except 'signing up')</span></em><span class="inline-comment-marker" data-ref="625bf25f-20d1-415d-bdee-1ce936573dd5"> possible to take without any previous authentication.</span></li></ul><ul><li>Please note, that from now on, I expect that each REST request (here proposed) is 'signed' by the <strong>username:password </strong>(i.e. authorization header is sent to ODALIC server with each query)</li><li>I will not be explicitly stating it anymore</li></ul><h3 id="RESTAPI-Users"><strong>Users</strong></h3><ul><li>(1) <strong>GET </strong>http://example.com/<strong>users</strong>/<strong>John</strong>/</li><li>Query (1) returns a basic info about an account with username &quot;<strong>John</strong>&quot;. (only 'John' and admins may execute such a query)</li><li>(2) <strong>GET </strong>http://example.com/<strong>users</strong>/</li><li>Query (2) returns a list of usernames (for admins <span>only</span>)</li></ul><h3 id="RESTAPI-Files">Files</h3><ul><li>A service for uploading files</li><li>May be used for uploading input files (*.CSV), uploading knowledge bases (*.RDF) and for the ODALIC system to store results to</li><li>(1)<strong> <span class="inline-comment-marker" data-ref="b78e87c6-41b3-4b69-9aee-343e0136eb51">PUT </span></strong><span class="nolink"><span class="inline-comment-marker" data-ref="b78e87c6-41b3-4b69-9aee-343e0136eb51">http://example.com/</span><strong><span class="inline-comment-marker" data-ref="b78e87c6-41b3-4b69-9aee-343e0136eb51">users</span></strong><span class="inline-comment-marker" data-ref="b78e87c6-41b3-4b69-9aee-343e0136eb51">/</span><strong><span class="inline-comment-marker" data-ref="b78e87c6-41b3-4b69-9aee-343e0136eb51">John</span></strong><span class="inline-comment-marker" data-ref="b78e87c6-41b3-4b69-9aee-343e0136eb51">/</span><strong><span class="inline-comment-marker" data-ref="b78e87c6-41b3-4b69-9aee-343e0136eb51">files</span></strong><span class="inline-comment-marker" data-ref="b78e87c6-41b3-4b69-9aee-343e0136eb51">/</span><strong><span class="inline-comment-marker" data-ref="b78e87c6-41b3-4b69-9aee-343e0136eb51">awesome_movies_2016</span></strong></span></li><li>(2)<strong> GET </strong><span class="nolink">http://example.com/<strong>users</strong>/<strong>John</strong>/<strong>files</strong>/<strong>awesome_movies_2016</strong></span></li><li><span class="inline-comment-marker" data-ref="fd80814c-8d06-4233-b40c-177387af657e">(3)</span><strong><span class="inline-comment-marker" data-ref="fd80814c-8d06-4233-b40c-177387af657e"> POST </span></strong><span class="nolink"><span class="inline-comment-marker" data-ref="fd80814c-8d06-4233-b40c-177387af657e">http://example.com/</span><strong><span class="inline-comment-marker" data-ref="fd80814c-8d06-4233-b40c-177387af657e">users</span></strong><span class="inline-comment-marker" data-ref="fd80814c-8d06-4233-b40c-177387af657e">/</span><strong><span class="inline-comment-marker" data-ref="fd80814c-8d06-4233-b40c-177387af657e">John</span></strong><span class="inline-comment-marker" data-ref="fd80814c-8d06-4233-b40c-177387af657e">/</span><strong><span class="inline-comment-marker" data-ref="fd80814c-8d06-4233-b40c-177387af657e">files</span></strong><span class="inline-comment-marker" data-ref="fd80814c-8d06-4233-b40c-177387af657e">/ </span></span></li><li><span class="nolink">(4) <strong>DELETE </strong><span class="nolink">http://example.com/<strong>users</strong>/<strong>John</strong>/<strong>files</strong>/<strong>awesome_movies_2016</strong></span></span></li><li>(5)<strong> GET </strong><span class="nolink">http://example.com/<strong>users</strong>/<strong>John</strong>/<strong>files</strong>/</span></li><li>Query (1) uploads a file. Regardless of the file's real name and format, it is assigned an identifier '<strong style="line-height: 1.42857;">awesome_movies_2016</strong>' (because 'John' set it this way). Only local files can be uploaded and only non-resumable upload is provided.<br/><ul><li><span class="inline-comment-marker" data-ref="952972a5-6faa-490c-96f5-4c9169674140">Uploading remote files, e.g. &quot;</span><u><span class="inline-comment-marker" data-ref="952972a5-6faa-490c-96f5-4c9169674140">http://site.com/my_awesome_table.CSV</span></u><span class="inline-comment-marker" data-ref="952972a5-6faa-490c-96f5-4c9169674140">&quot; is not possible. That should not be an issue since tasks can be pointed to any resource (URI).</span></li></ul></li><li>Query (2) returns (i.e. may be used for downloading) a file with the corresponding identifier <span>'</span><strong>awesome_movies_2016</strong><span>'. </span></li><li><span><span class="inline-comment-marker" data-ref="f830bd45-2296-4a92-a7ef-22ccd91f438d">Query (3) uploads a file in a similar way the query (1) does, however it constructs a random unique identifier, which is returned to the user should the operation succeed.</span></span><ul><li><em><span class="inline-comment-marker" data-ref="f830bd45-2296-4a92-a7ef-22ccd91f438d">Yes, it may be pointless since it does not do anything different from (1) besides generating a random identifier, but for now I would leave it be, since the implementation is not difficult. It may prove later useful e.g. for the web backend.</span></em></li></ul></li><li><span><span>Query (4) </span>removes the file with the corresponding identifier, should it exist.</span></li><li><span><span>Query (5) returns a list of all the files. The list should probably contain additional information for each file, such as &quot;date uploaded&quot;, &quot;format&quot;, etc.</span></span><ul><li><span><span>To keep additional information for each file, certain data should be store in a DB. Especially vital is referencing an owner of each file.</span></span></li><li><span><span>Another option is using some kind of operating system's file system support for keeping additional data for each file. This is discouraged, however, due to performance issues.</span></span></li></ul></li></ul><ul><li>(8)<strong> GET </strong><span class="nolink">http://example.com/<strong>files</strong>/</span></li><li>Query (8) will return a list of all files of all users. Only an administrator may execute such a query.</li><li><strong>Notes for uploading an input file:</strong><ul><li>An input CSV file should be uploaded via (1) or (3). If it is not uploaded, a task may still reference a remote file.</li><li>A meta-information (schema) file should be uploaded via (1) or (3). <span>If it is not uploaded, a task may still reference a remote file.</span></li><li>A meta-information file shall always be created. In <a href="Scenario-1-Task-creation_71439879.html">Scenario 1 Task creation</a> if the meta-information file is omitted, it is still created as a result of the step 5 <em>(manual specification of line-endings, encoding, etc)</em>. If both the meta-information file is provided and &quot;options&quot; are specified, a new meta-information file shall be created overriding the previous one and be uploaded in its stead. <em>(It is suggested to delete the previous one in that case.) </em>For a combination of &quot;remote meta-information file&quot; and &quot;options provided&quot;, the former meta-information file shall be temporarily downloaded, rewritten using the data from &quot;options&quot;, and then uploaded via (1) or (3).</li></ul></li></ul><h3 id="RESTAPI-Tasks"><span class="nolink"><span>Tasks</span></span></h3><ul><li>A task is a wrapper for a user's conversion, containing relevant data</li><li><span class="nolink"><span>A task consists of a 'mutable' part and of an 'immutable' part</span></span></li><li><span class="nolink"><span>A 'mutable part' carries important data that my be updated <strong>after</strong> the task has been already created, such as <em>state</em></span></span><ul><li><span class="nolink"><span>Consider e.g.: 'running task', 'queued task', 'finished task', 'canceled task', etc.</span></span></li><li><span class="nolink"><span>Also where the resulting file is stored, suggestions, etc.</span></span></li></ul></li><li><span class="nolink"><span>An 'immutable part' must be set before the task can run on the TableMiner+, at the time of the construction of the task</span></span><ul><li><span class="nolink"><span>For instance, KB used, configuration, input constraints (i.e. feedback), etc.</span></span></li></ul></li><li>A task may be canceled if it is in the 'running' state (or 'queued')</li></ul><ul><li>(1) <strong>PUT </strong><span class="nolink">http://example.com/<strong>users</strong>/<strong>John</strong>/<strong>tasks</strong>/<strong>simple_task</strong></span></li><li>(2) <strong>GET </strong><span class="nolink">http://example.com/<strong>users</strong>/<strong>John</strong>/<strong>tasks</strong>/<strong>simple_task</strong></span></li><li>(3) <strong>POST </strong><span class="nolink">http://example.com/<strong>users</strong>/<strong>John</strong>/<strong>tasks</strong>/</span></li><li>(4) <strong style="line-height: 1.42857;">DELETE </strong><span class="nolink" style="line-height: 1.42857;">http://example.com/<strong>users</strong>/<strong>John</strong>/<strong>tasks</strong>/<strong>simple_task</strong></span></li><li>(5) <strong>GET </strong><span class="nolink">http://example.com/<strong>users</strong>/<strong>John</strong>/<strong>tasks</strong>/</span></li><li><span class="nolink">Query (1) creates a new task with an identifier '<strong>simple_task</strong>'. A task should be provided in JSON format, but the details are not yet specified. Generally we can, probably, agree that a task should carry at least these values:</span><ul><li><strong><span class="inline-comment-marker" data-ref="c4184c37-34d5-4047-bd7e-daba73d77b87">Input file as a general URI.</span></strong><ul><li><span class="inline-comment-marker" data-ref="c4184c37-34d5-4047-bd7e-daba73d77b87">This can be also pointed to e.g. http://example.com/<strong>users</strong>/<strong>John</strong>/<strong>files</strong>/<strong>awesome_movies_2016 </strong><em>(use an already uploaded file)</em></span></li></ul></li><li><strong><span class="inline-comment-marker" data-ref="c4184c37-34d5-4047-bd7e-daba73d77b87">Meta-information file for the input file as a general URI.</span></strong><ul><li><span class="inline-comment-marker" data-ref="c4184c37-34d5-4047-bd7e-daba73d77b87">The same principle applies as for the input file, i.e. <span>http://example.com/</span><strong>users</strong><span>/</span><strong>John</strong><span>/</span><strong>files</strong><span>/</span><strong>awesome_movies_2016_mi </strong>may be specified <em>(use an already uploaded file)</em></span></li></ul></li><li><strong>Knowledge Base</strong><ul><li><span class="nolink"><span class="inline-comment-marker" data-ref="05775da6-1cf0-4b62-b371-fbd6ebb84fd9"><span style="color: rgb(255,0,0);"><em>I'll get back to this later.</em></span><br/></span></span></li><li><span class="nolink"><span class="inline-comment-marker" data-ref="05775da6-1cf0-4b62-b371-fbd6ebb84fd9">e.g. </span></span><span class="nolink" style="line-height: 1.42857;"><code><span class="inline-comment-marker" data-ref="05775da6-1cf0-4b62-b371-fbd6ebb84fd9">{ value: &quot;</span><strong><span class="inline-comment-marker" data-ref="05775da6-1cf0-4b62-b371-fbd6ebb84fd9">freebase_rdf</span></strong><span class="inline-comment-marker" data-ref="05775da6-1cf0-4b62-b371-fbd6ebb84fd9">&quot;, type: &quot;</span><strong><span class="inline-comment-marker" data-ref="05775da6-1cf0-4b62-b371-fbd6ebb84fd9">fi</span></strong></code><code><span class="inline-comment-marker" data-ref="05775da6-1cf0-4b62-b371-fbd6ebb84fd9">&quot; }</span></code><span class="inline-comment-marker" data-ref="05775da6-1cf0-4b62-b371-fbd6ebb84fd9">, for </span><strong><span class="inline-comment-marker" data-ref="05775da6-1cf0-4b62-b371-fbd6ebb84fd9">file identifier </span></strong><span class="inline-comment-marker" data-ref="05775da6-1cf0-4b62-b371-fbd6ebb84fd9">in </span><strong><span class="inline-comment-marker" data-ref="05775da6-1cf0-4b62-b371-fbd6ebb84fd9">Files</span></strong><span class="inline-comment-marker" data-ref="05775da6-1cf0-4b62-b371-fbd6ebb84fd9"> service</span></span></li><li><span class="nolink" style="line-height: 1.42857;"><span class="inline-comment-marker" data-ref="05775da6-1cf0-4b62-b371-fbd6ebb84fd9">e.g. </span><code><span class="inline-comment-marker" data-ref="05775da6-1cf0-4b62-b371-fbd6ebb84fd9">{ value: &quot;</span><strong><span class="inline-comment-marker" data-ref="05775da6-1cf0-4b62-b371-fbd6ebb84fd9">http://sparqlendpoint.whatever</span></strong><span class="inline-comment-marker" data-ref="05775da6-1cf0-4b62-b371-fbd6ebb84fd9">&quot;, type: &quot;</span><strong><span class="inline-comment-marker" data-ref="05775da6-1cf0-4b62-b371-fbd6ebb84fd9">se</span></strong></code><code><span class="inline-comment-marker" data-ref="05775da6-1cf0-4b62-b371-fbd6ebb84fd9">&quot; }, </span></code><span class="inline-comment-marker" data-ref="05775da6-1cf0-4b62-b371-fbd6ebb84fd9">for </span><strong><span class="inline-comment-marker" data-ref="05775da6-1cf0-4b62-b371-fbd6ebb84fd9">SPARQL endpoint</span></strong></span></li><li><span class="nolink" style="line-height: 1.42857;"><span class="inline-comment-marker" data-ref="05775da6-1cf0-4b62-b371-fbd6ebb84fd9">It should be noted that multiple KBs may be specified and with an explicitly defined ordering. The ordering is relevant for the algorithm.</span></span></li></ul></li><li><strong>Feedback <em>('input constraints')</em></strong><ul><li>As for what the &quot;POST-ed&quot; / &quot;PUT-ed&quot; data should look like, well, that is for another (possibly quite long) discussion. But in short:<br/><ul><li><span class="nolink">Index of the column that has been chosen as the &quot;subject&quot;</span></li><li><span class="nolink">For each constrained column:</span><ul><li>Index of the column</li><li>May or may not specify a name for the column. If a name was already defined in the input file, this will override it.</li><li>Feedback, either:<ul><li>Classification X is wrong</li><li>A user thinks, a classification X is the correct one</li><li>A user thinks, a classification X1 from KB1 is the correct one, also a classification X2 from KB2 is the correct one, etc.</li></ul></li><li>Additionally, the following should be possible as well:<ul><li>'Do not classify this column'</li><li>'Do not disambiguate the cells below' <em>(the whole column will be omitted in the result)</em></li></ul></li></ul></li><li>For each constrained cell:<ul><li>Location of the cell <em>(column + row)</em></li><li>Feedback<em> (similar to columns)</em></li><li>'Do not disambiguate this cell'<em> (do not include in the result)</em></li></ul></li></ul></li></ul></li><li><strong>RDF export configuration <em>('output constraints')</em></strong><ul><li>Requirement motivated by <a href="72222951.html">Story: Export resulting data as RDF data</a>.</li><li>Similar to feedback, but new predicates and new objects may be defined as well.</li><li><em>The format was proposed in the glosary ('<span>SPARQL triple patterns'</span>) </em></li></ul></li><li>Constraints about where to place an output, if applicable (e.g. using an external RDF store)</li><li><em>Others may yet to come.</em></li></ul></li><li>The task is immediately 'queued' and will be run on TableMiner+ when ready. Since <strong>PUT</strong> must ensure idempotency, the task is inserted only if there was no previous task with an identifier '<strong style="line-height: 1.42857;">simple_task</strong>'.<ul><li>Otherwise an error message shall be returned.</li></ul></li><li>Query (2) returns the data for &quot;<strong>simple_task</strong>&quot;.<ul><li>The data returned contains more information than was previously inserted via query (1). Namely:<ul><li>Date of creation of the task</li><li>State of the task <em>('running', 'finished', ...)</em></li><li>In case the conversion has finished, a file identifier in <strong>Files </strong>service leading to the result <ul><li>Yes, once a conversion finishes, ODALIC should automatically store the resulting file into the user's <strong>Files</strong></li><li>Only if no external RDF store was specified</li></ul></li></ul></li><li>An important point to note is that certain items, such as 'state', may (will) change throughout the time. Therefore using this query may result in different data returned each time.</li></ul></li><li><span>Query (3) is similar to query (1), however a random identifier for our task. This identifier is returned as a response.</span><ul><li><span>Also it should be noted using this query multiple times results in multiple running instances of the same task.</span></li></ul></li><li><span>Query (4) <strong>stops</strong> the corresponding task, if it is running.<strong> </strong>It also <strong>deletes</strong> the corresponding task (presumably from a DB). If the task already produced an <strong>output file</strong>, it <strong>won't be deleted. </strong>The<strong> 'draft' output file, </strong>however,<strong> will be deleted</strong>, since the GUI does not support means for manipulating the 'draft' files directly.</span></li><li>Query (5) returns a list of all tasks created (and not yet deleted).</li><li>In query (4), according to <a href="Scenario-3e-Tasks-overview---Cancelling-a-task-and-other-state-commands_72224432.html">Scenario 3e Tasks overview - Cancelling a task and other state commands</a>, it is necessary to be able not to delete the task, but to cancel it only. Since I did not find any more suitable verb than DELETE, I propose for &quot;cancelling task only&quot; using either of the following:<ul><li>(6) <strong>DELETE </strong><span class="nolink">http://example.com/<strong>users</strong>/<strong>John</strong>/<strong>tasks</strong>/<strong>simple_task?select=&quot;computation&quot;</strong></span></li><li>(7) <strong>DELETE </strong><span class="nolink">http://example.com/<strong>users</strong>/<strong>John</strong>/<strong>tasks</strong>/<strong>simple_task/computation </strong><em>(preferred)</em></span></li></ul></li><li><span class="nolink">Now it would be strange, if it applied only to 'DELETE', therefore</span><strong style="line-height: 1.42857;"><span class="nolink"> I propose for all of the queries <em>(with an exception of query 5)</em> adding the following syntax:</span></strong><ul><li>(8) <strong>VERB </strong><span class="nolink">http://example.com/<strong>users</strong>/<strong>John</strong>/<strong>tasks</strong>/<strong>simple_task/computation</strong></span></li><li>(9) <strong style="line-height: 1.42857;">VERB </strong><span class="nolink" style="line-height: 1.42857;">http://example.com/<strong>users</strong>/<strong>John</strong>/<strong>tasks</strong>/<strong>simple_task/<span class="inline-comment-marker" data-ref="1bff39e3-e4f5-45cd-9490-f99568306518">settings</span></strong></span></li><li>(10) <strong>VERB </strong><span class="nolink">http://example.com/<strong>users</strong>/<strong>John</strong>/<strong>tasks</strong>/<strong>simple_task<span class="inline-comment-marker" data-ref="63d70b1c-b844-4870-b8b2-11dad2f2fb3a">/draft</span></strong></span></li><li><span class="nolink">(11)<strong><span> </span><strong>VERB </strong></strong><span class="nolink">http://example.com/<strong>users</strong>/<strong>John</strong>/<strong>tasks</strong>/<strong>simple_task/result</strong></span></span></li></ul></li><li>Each task can be <strong>associated with exactly 0..1 running computations</strong>. This allows for an eff<span class="inline-comment-marker" data-ref="caffef0e-ad30-4a7c-906c-6080f7e8da98">ective reexe</span>cution and cancelation of a task.<ul><li><span class="nolink">The (8) refers to a task's computation, only. </span><ul><li><strong>PUT:</strong> runs the computation, if not already running<ul><li>The computation may be specified using 'flags' from the following:</li><li><strong><span class="inline-comment-marker" data-ref="ed981584-6073-40e8-bad5-6748e235809f">Draft: </span></strong><span class="inline-comment-marker" data-ref="ed981584-6073-40e8-bad5-6748e235809f">The task will execute and produce a so called 'draft', which is a file containing 'suggestions' and other data from TableMiner+ relevant for a construction of a 'Feedback' or of a simple resulting RDF file.</span></li><li><strong><span class="inline-comment-marker" data-ref="ed981584-6073-40e8-bad5-6748e235809f">Export</span></strong><span class="inline-comment-marker" data-ref="ed981584-6073-40e8-bad5-6748e235809f">:</span> A phase 'RDF export' is executed. A 'draft' must have been already produced, otherwise the task with only this flag will fail. On the contrary, if a 'resulting RDF' was already produced, it will be replaced with a new version.</li><li><em>Additional flags may yet to come.</em></li></ul></li><li><strong>GET:</strong> returns, whether the task is 'running', 'stopped', etc.</li><li><span class="nolink"><strong>DELETE:</strong> stops the computation</span></li><li><em>POST: unavailable</em></li></ul></li><li><span class="nolink">The (9) refers to a task's data <em>(wrapper, if you will)</em>, only.</span><ul><li><strong><span class="nolink">PUT: </span></strong><span class="nolink">the same as query (1) with an exception the task is not immediately run. If the task is already running, the query will succeed, however it will not influence the already running computation.</span><ul><li><span class="nolink">Implementation details: TableMiner+ will need to work with its own copy of a task.</span></li></ul></li><li><span class="nolink"><strong>GET:</strong> returns the task's data <em>('wrapper')</em>, omits the 'state' and 'result' part </span></li><li><em><span class="nolink">DELETE: unavailable. The task needs to be deleted as a whole.</span></em></li><li><em><span class="nolink">POST: </span><span class="nolink"><span class="nolink">unavailable.</span></span></em></li><li><span class="nolink"><span class="nolink">This query may be subsequently 'separated', e.g.:</span></span><ul><li>(12) <strong>VERB</strong> http://example.com/<strong>users</strong>/<strong>John</strong>/<strong>tasks</strong>/<strong>simple_task/settings/feedback</strong><ul><li>For configuration of a task's 'Feedback' only.</li></ul></li><li>(13) <strong><strong>VERB</strong> </strong><span class="nolink">http://example.com</span><strong>/<strong>users</strong>/<strong>John</strong>/<strong>tasks</strong>/<strong>simple_task/settings/rdfexportconfig</strong></strong><ul><li>For configuration of a task's 'RDF Export Configuration' only.</li></ul></li><li>(14) <strong><strong>VERB</strong> </strong><span class="nolink">http://example.com/</span><strong>/<strong>users</strong>/<strong>John</strong>/<strong>tasks</strong>/<strong>simple_task/settings/general</strong></strong><ul><li>For configuration of everything else besides a task's 'Feedback' and 'RDF Export Configuration'.</li></ul></li></ul></li></ul></li><li><span class="nolink"><span class="nolink"><span>The (10) refers to a task's 'draft' <em>(previously called suggestions)</em></span><span>, only. </span></span></span><ul><li><span class="nolink"><span class="nolink">The task's 'draft' consists of several suggestions for cells disambiguations and columns classifications.<em><br/></em></span></span></li><li><span class="nolink"><span class="nolink">I won't specify the exact format here, however an outline is described here:</span></span><ul><li><span class="nolink"><span class="nolink">It may be of JSON format for simplicity.</span></span></li><li><span class="nolink"><span class="nolink">The subject column is defined.</span></span></li><li><span class="nolink"><span class="nolink">For each column and for each KB, several suggestions are presented.</span></span></li><li>e.g.: <code style="line-height: 1.42857;">[/* column 1 */, /* column 2 */, { ADEQUATE_KB : [&quot;http://adequate.at/concept/City&quot;, &quot;http://adequate.at/concept/lauName&quot;, /* additional suggestions */], FREEBASE_KB : [/* suggestions... */] }, /* additional columns... */]</code></li><li>A similar format shall be used for cell disambiguation suggestions and relations as well.</li></ul></li><li>Before we go in further detail, it is important to state that the 'draft' file does not directly use Files REST service. It is tightly coupled with a wrapping task and the only ways for manipulating the file are stated here. Therefore deleting a whole task will always result in deleting the 'draft' file as well.</li><li><em style="line-height: 1.42857;">PUT: unavailable</em></li><li><strong>GET:</strong> returns the 'draft' file</li><li><strong>DELETE: </strong>removes the 'draft'</li><li><em>POST: unavailable</em></li><li>There may be a need for a mechanism for querying only certain parts of the file. Something in a following way:<ul><li><strong>GET </strong>http://example.com/<strong>users</strong>/<strong>John</strong>/<strong>tasks</strong>/<strong>simple_task/draft?column=&quot;</strong><strong style="line-height: 1.42857;">['col1', 'col2']&quot;&amp;cells=&quot;['10,30', '15,20']&quot;</strong></li><li>We will use GET parameters in the query. Using 'slashes' probably would not be effective <em>(restrictive queries)</em>.</li><li>Of course, DELETE here is not applicable and shall result in an error.</li></ul></li></ul></li><li>The (11) refers to a task's result, only. <em><br/></em><ul><li><em>PUT: unavailable</em></li><li><strong>GET:</strong> returns the result (u<em style="line-height: 1.42857;">sing http 303 redirect to files service, where the resulting file is stored</em>)</li><li><strong>DELETE: </strong>removes the result</li><li><em>POST: unavailable</em></li></ul></li></ul></li></ul><ul><li>(15) <strong>GET </strong><span class="nolink">http://example.com/<strong>tasks</strong>/</span></li><li><span style="color: rgb(0,0,0);">Query (15) returns a list of all tasks of all users. Only an administrator may execute such a query.</span></li><li><span style="color: rgb(0,0,0);">Similar 'separators' <em>(e.g. /tasks/computation, /tasks/settings/feedback)</em> apply here as well.</span></li></ul><h3 id="RESTAPI-Additionalnotes"><span class="nolink">Additional notes</span></h3><ul><li>What should happen if a certain 'object' is removed, but still referenced from another 'object'? (e.g. a removed file, but still referenced from a task) Well, nothing. There is no &quot;cascade&quot; or any other similar concept found e.g. in RDMBS. We don't detect it. However, this may cause an error later (e.g. creating a conversion from a task that had its input file deleted. <em>This may be solved by rewriting the 'task object' and putting an error message there.</em>)</li></ul>
                    </div>

                    
                                                      
                </div>             </div> 
            <div id="footer" role="contentinfo">
                <section class="footer-body">
                    <p>Document generated by Confluence on Jun 01, 2017 13:30</p>
                    <div id="footer-logo"><a href="http://www.atlassian.com/">Atlassian</a></div>
                </section>
            </div>
        </div>     </body>
</html>
